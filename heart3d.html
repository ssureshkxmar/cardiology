<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Heart 3D ‚Äî Cardiology AI</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        :root {
            --glass-bg: rgba(255, 255, 255, 0.02);
            --glass-border: rgba(255, 255, 255, 0.08);
            --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.7);
            --glass-hover: rgba(255, 255, 255, 0.05);
            --primary-gradient: linear-gradient(135deg, #00d4ff 0%, #0099ff 100%);
            --accent-gradient: linear-gradient(135deg, #ff006e 0%, #8338ec 100%);
            --success-gradient: linear-gradient(135deg, #06ffa5 0%, #00d4ff 100%);
            --text-primary: rgba(255, 255, 255, 0.95);
            --text-secondary: rgba(255, 255, 255, 0.65);
            --text-muted: rgba(255, 255, 255, 0.45);
            --backdrop-blur: blur(25px);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            height: 100%;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
            background: #000000;
            color: var(--text-primary);
            position: relative;
            overflow-x: hidden;
        }

        /* Full Black Background - No gradients */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000000;
            z-index: 0;
            pointer-events: none;
        }

        /* Ultra-transparent GOV header */
        .gov-header {
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(30px) saturate(180%);
            -webkit-backdrop-filter: blur(30px) saturate(180%);
            border-bottom: 1px solid rgba(255, 255, 255, 0.06);
            padding: 10px 28px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 14px;
            position: sticky;
            top: 0;
            z-index: 999;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.4);
        }

        .gov-left {
            display: flex;
            gap: 14px;
            align-items: center;
        }

        .gov-emblem {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            background: #000000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2px;
            position: relative;
            overflow: hidden;
        }

        .gov-emblem img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            filter: brightness(1.1) contrast(1.2) drop-shadow(0 0 10px rgba(218, 165, 32, 0.6));
            mix-blend-mode: screen;
        }

        .gov-title {
            display: flex;
            flex-direction: column;
        }

        .gov-sub {
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.12em;
            font-weight: 600;
        }

        .gov-main {
            font-size: 1rem;
            color: var(--text-primary);
            font-weight: 700;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Ultra-transparent app banner */
        .app-banner {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(30px) saturate(180%);
            -webkit-backdrop-filter: blur(30px) saturate(180%);
            border-bottom: 1px solid rgba(255, 255, 255, 0.06);
            padding: 20px 28px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            overflow: hidden;
        }

        .app-header-left {
            display: flex;
            align-items: center;
            gap: 16px;
            position: relative;
            z-index: 1;
        }

        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(25px) saturate(180%);
            -webkit-backdrop-filter: blur(25px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .back-button:hover {
            background: rgba(0, 100, 150, 0.3);
            transform: translateX(-4px);
            border-color: rgba(0, 212, 255, 0.5);
            box-shadow: 0 4px 20px rgba(0, 212, 255, 0.3);
        }

        .app-header-content {
            display: flex;
            flex-direction: column;
        }

        .app-title {
            font-weight: 700;
            font-size: 1.4rem;
            background: linear-gradient(135deg, #fff 0%, #00d4ff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .app-desc {
            font-size: 0.95rem;
            color: var(--text-secondary);
            margin-top: 6px;
        }

        .app-header-right {
            font-size: 0.85rem;
            text-align: right;
            color: var(--text-secondary);
            position: relative;
            z-index: 1;
        }

        .app-header-right span {
            display: block;
        }

        .app-header-right strong {
            color: #00d4ff;
            font-weight: 700;
        }

        /* Layout */
        .wrapper {
            max-width: 1400px;
            margin: 32px auto;
            padding: 0 28px;
            display: grid;
            grid-template-columns: 320px 1fr;
            gap: 24px;
            align-items: start;
            position: relative;
            z-index: 1;
        }

        @media (max-width: 980px) {
            .wrapper {
                grid-template-columns: 1fr;
                padding: 0 16px;
            }
        }

        /* Ultra-transparent sidebar */
        .sidebar {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(30px) saturate(180%);
            -webkit-backdrop-filter: blur(30px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 20px;
            padding: 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
            position: sticky;
            top: 100px;
        }

        .sidebar h3 {
            font-size: 1.15rem;
            color: #00d4ff;
            margin-bottom: 12px;
            text-shadow: 0 0 25px rgba(0, 212, 255, 0.6);
        }

        .sidebar p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .sidebar label {
            display: block;
            color: var(--text-primary);
            margin-bottom: 8px;
            margin-top: 16px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        select.dropbtn {
            width: 100%;
            padding: 12px 14px;
            border-radius: 12px;
            border: 1px solid rgba(0, 212, 255, 0.2);
            background: rgba(0, 212, 255, 0.03);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            color: var(--text-primary);
            font-weight: 600;
            font-size: 0.9rem;
            appearance: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        select.dropbtn:focus {
            outline: none;
            border-color: #00d4ff;
            box-shadow: 0 0 0 3px rgba(0, 212, 255, 0.2);
            background: rgba(0, 212, 255, 0.08);
        }

        .sidebar .control-btn {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }

        .sidebar .control-btn button {
            flex: 1;
            padding: 12px 14px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(25px) saturate(180%);
            -webkit-backdrop-filter: blur(25px) saturate(180%);
            color: var(--text-primary);
            font-weight: 700;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .sidebar .control-btn button:hover {
            background: rgba(0, 100, 150, 0.3);
            border-color: rgba(0, 212, 255, 0.5);
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0, 212, 255, 0.3);
        }

        .sidebar .note {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-top: 20px;
            line-height: 1.5;
            padding: 12px;
            background: rgba(0, 212, 255, 0.03);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 12px;
            border: 1px solid rgba(0, 212, 255, 0.1);
        }

        /* Ultra-transparent panel */
        .panel {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(30px) saturate(180%);
            -webkit-backdrop-filter: blur(30px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 20px;
            padding: 24px;
            min-height: 600px;
            position: relative;
            display: flex;
            flex-direction: column;
            gap: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
        }

        .panel .panel-head {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 16px;
        }

        .panel h2 {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin: 0;
        }

        .panel .subtitle {
            color: var(--text-secondary);
            font-size: 0.95rem;
            margin-top: 6px;
        }

        /* 3D view container with deep black background */
        #glView {
            position: relative;
            background: #000000;
            border-radius: 16px;
            border: 1px solid rgba(0, 212, 255, 0.15);
            overflow: hidden;
            min-height: 600px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.8),
                inset 0 0 80px rgba(0, 212, 255, 0.08);
        }

        canvas#three-canvas {
            width: 100%;
            height: 100%;
            display: block;
        }

        .ui-overlay {
            position: absolute;
            z-index: 30;
            top: 16px;
            left: 16px;
            right: 16px;
            display: flex;
            justify-content: space-between;
            gap: 16px;
            color: #fff;
            pointer-events: none;
        }

        .ui-left, .ui-right {
            pointer-events: auto;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .status {
            padding: 10px 16px;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(30px) saturate(180%);
            -webkit-backdrop-filter: blur(30px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            font-size: 0.9rem;
            font-weight: 600;
            color: #00d4ff;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }

        .error-box {
            position: absolute;
            left: 16px;
            bottom: 16px;
            z-index: 40;
            background: rgba(255, 0, 110, 0.15);
            backdrop-filter: blur(30px) saturate(180%);
            -webkit-backdrop-filter: blur(30px) saturate(180%);
            border: 1px solid rgba(255, 0, 110, 0.4);
            color: #fff;
            padding: 12px 16px;
            border-radius: 12px;
            display: none;
            max-width: 60%;
            font-weight: 600;
            box-shadow: 0 8px 30px rgba(255, 0, 110, 0.5);
        }

        .controls-top {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .small-btn {
            padding: 10px 16px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(30px) saturate(180%);
            -webkit-backdrop-filter: blur(30px) saturate(180%);
            color: var(--text-primary);
            cursor: pointer;
            font-weight: 700;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }

        .small-btn:hover {
            background: var(--primary-gradient);
            color: #000;
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0, 212, 255, 0.5);
        }

        .footer-note {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-top: 8px;
            padding: 12px;
            background: rgba(0, 212, 255, 0.03);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 12px;
            border: 1px solid rgba(0, 212, 255, 0.1);
        }

        @media (max-width: 980px) {
            .app-banner {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .app-header-right {
                text-align: left;
            }
        }

        @media (max-width: 640px) {
            .gov-header {
                padding: 10px 16px;
            }

            .wrapper {
                margin: 20px auto;
            }

            .ui-overlay {
                flex-direction: column;
                gap: 8px;
            }

            .controls-top {
                width: 100%;
            }

            .small-btn {
                flex: 1;
            }

            .app-header-left {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }
        }
    </style>
</head>
<body>
    <header class="gov-header" role="banner">
        <div class="gov-left">
            <div class="gov-emblem">
                <img src="image.jpg" alt="Student of India Emblem">
            </div>
            <div class="gov-title">
                <span class="gov-sub">Student of India</span>
                <span class="gov-main">Ministry of Health & Family Welfare</span>
            </div>
        </div>
        <div style="color: var(--text-secondary); font-size: 0.9rem; font-weight: 500;">Cardiology AI ‚Äî 3D Heart Viewer</div>
    </header>

    <div class="app-banner">
        <div class="app-header-left">
            <a href="heart.html" class="back-button">
                <span>‚Üê</span>
                <span>Back</span>
            </a>
            <div class="app-header-content">
                <span class="app-title">ü´Ä Heart 3D Model Viewer</span>
                <span class="app-desc">Base PBR model ‚Äî interactive viewer with advanced rendering</span>
            </div>
        </div>
        <div class="app-header-right">
            <span>Environment: <strong>Demo</strong></span>
            <span>Data Source: 3D Medical Model</span>
        </div>
    </div>

    <div class="wrapper">
        <aside class="sidebar" aria-label="Viewer controls">
            <h3>‚öôÔ∏è Controls</h3>
            <p>Select display mode and control auto-rotation or reset the camera.</p>

            <label for="renderMode">üé® Render Mode</label>
            <select id="renderMode" class="dropbtn">
                <option value="color">Color</option>
                <option value="matcap">Matcap (if available)</option>
                <option value="wireframe">Wireframe</option>
            </select>

            <label for="modelScale">üìè Model Scale</label>
            <select id="modelScale" class="dropbtn">
                <option value="1">1x</option>
                <option value="0.75">0.75x</option>
                <option value="0.5">0.5x</option>
                <option value="1.25">1.25x</option>
                <option value="1.5">1.5x</option>
            </select>

            <div class="control-btn">
                <button onclick="toggleAutoRotate()">üîÑ Auto-Rotate</button>
                <button onclick="resetCamera()">üéØ Reset</button>
            </div>

            <div class="note">
                üí° <strong>Tip:</strong> Use mouse/touch to rotate and zoom. If the model does not appear, open the browser console to inspect loader errors.
            </div>
        </aside>

        <main class="panel" aria-label="3D Viewer panel">
            <div class="panel-head">
                <div>
                    <h2>Heart ‚Äî base_basic_pbr.glb</h2>
                    <div class="subtitle">Interactive PBR model displayed in premium viewport</div>
                </div>
                <div style="font-size: 0.9rem; color: var(--text-muted); font-weight: 600;">3D Viewer</div>
            </div>

            <div id="glView" role="application" aria-label="3D model viewport">
                <!-- UI overlay inside the black viewport -->
                <div class="ui-overlay">
                    <div class="ui-left">
                        <div class="status" id="viewer-status">‚è≥ Loading model...</div>
                    </div>
                    <div class="ui-right">
                        <div class="controls-top">
                            <button class="small-btn" id="btn-screenshot" title="Screenshot">üì∏ Screenshot</button>
                            <button class="small-btn" id="btn-centered" title="Fit model">üéØ Fit</button>
                        </div>
                    </div>
                </div>

                <!-- canvas for three -->
                <canvas id="three-canvas"></canvas>

                <!-- error box -->
                <div id="error-box" class="error-box" role="alert">‚ö†Ô∏è Error loading model. See console for details.</div>
            </div>

            <div class="footer-note">
                ‚ö†Ô∏è <strong>Note:</strong> This viewer is for demonstration only. Not intended for diagnostic use.
            </div>
        </main>
    </div>

    <!-- Three.js module loader (local paths) -->
    <script type="module">
        import * as THREE from './libraries/threejs/build/three.module.js';
        import {OrbitControls} from './libraries/threejs/examples/jsm/controls/OrbitControls.js';
        import {GLTFLoader} from './libraries/threejs/examples/jsm/loaders/GLTFLoader.js';
        import {DRACOLoader} from './libraries/threejs/examples/jsm/loaders/DRACOLoader.js';

        // Configuration
        const MODEL_URL = './base_basic_pbr.glb';
        const canvas = document.getElementById('three-canvas');
        const statusEl = document.getElementById('viewer-status');
        const errorBox = document.getElementById('error-box');

        // Renderer with enhanced settings
        const renderer = new THREE.WebGLRenderer({ 
            canvas: canvas, 
            antialias: true, 
            alpha: false,
            powerPreference: 'high-performance'
        });
        renderer.setPixelRatio(window.devicePixelRatio || 1);
        renderer.setClearColor(0x000000, 1); // Pure black background
        renderer.outputEncoding = THREE.sRGBEncoding;
        renderer.toneMapping = THREE.ACESFilmicToneMapping;
        renderer.toneMappingExposure = 1.2;

        // Scene and camera
        const scene = new THREE.Scene();
        scene.fog = new THREE.Fog(0x000000, 10, 50);
        
        const camera = new THREE.PerspectiveCamera(45, canvas.clientWidth / canvas.clientHeight, 0.1, 5000);

        // Resize after camera is created
        resizeRendererToDisplaySize();
        camera.position.set(0, 0.25, 1.3);

        // Controls (orbit)
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.07;
        controls.autoRotate = true;
        controls.autoRotateSpeed = 1.0;

        // Enhanced lighting setup for better visibility
        const hemi = new THREE.HemisphereLight(0xffffff, 0x444444, 2.0);
        scene.add(hemi);

        const dir = new THREE.DirectionalLight(0xffffff, 2.5);
        dir.position.set(2, 2, 3);
        dir.castShadow = false;
        scene.add(dir);

        const rim = new THREE.DirectionalLight(0x00d4ff, 1.2);
        rim.position.set(-2, 1, -1);
        scene.add(rim);

        const ambientBoost = new THREE.AmbientLight(0xffffff, 1.0);
        scene.add(ambientBoost);

        const fillLight = new THREE.DirectionalLight(0xff006e, 0.8);
        fillLight.position.set(-5, 0, -5);
        scene.add(fillLight);

        // Model container group
        const root = new THREE.Group();
        root.name = 'model-root';
        scene.add(root);

        // GLTF Loader
        const gltfLoader = new GLTFLoader();

        // Helper: center and fit model
        let modelMesh = null;
        function fitModelToView(object) {
            const box = new THREE.Box3().setFromObject(object);
            const size = box.getSize(new THREE.Vector3());
            const center = box.getCenter(new THREE.Vector3());

            const maxDim = Math.max(size.x, size.y, size.z);
            const fov = camera.fov * (Math.PI / 180);
            let cameraZ = Math.abs(maxDim / 2 / Math.tan(fov / 2)) * 1.3;

            camera.position.set(center.x, center.y, cameraZ + center.z + 0.1);
            const minZ = box.min.z;
            const cameraToFarEdge = (minZ < 0) ? -minZ + cameraZ : cameraZ - minZ;
            camera.far = cameraToFarEdge * 4;
            camera.updateProjectionMatrix();

            controls.target.copy(center);
            controls.update();
        }

        // Load model
        function loadModel() {
            statusEl.textContent = '‚è≥ Loading model...';
            console.log('Loading GLB:', MODEL_URL);

            gltfLoader.load(
                MODEL_URL,
                (gltf) => {
                    while (root.children.length) root.remove(root.children[0]);

                    const sceneRoot = gltf.scene || gltf.scenes[0];
                    modelMesh = sceneRoot;

                    sceneRoot.traverse((child) => {
                        if (child.isMesh) {
                            child.castShadow = true;
                            child.receiveShadow = true;
                        }
                    });

                    root.add(sceneRoot);
                    fitModelToView(root);

                    statusEl.textContent = '‚úÖ Model loaded';
                    errorBox.style.display = 'none';
                    console.log('GLTF loaded successfully:', gltf);
                },
                (xhr) => {
                    if (xhr && xhr.total) {
                        const pct = (xhr.loaded / xhr.total) * 100;
                        statusEl.textContent = `‚è≥ Loading model... ${pct.toFixed(0)}%`;
                    } else {
                        statusEl.textContent = '‚è≥ Loading model...';
                    }
                },
                (err) => {
                    console.error('GLTF load error', err);
                    statusEl.textContent = '‚ùå Failed to load model';
                    errorBox.style.display = 'block';
                    errorBox.textContent = '‚ö†Ô∏è Error loading model. Check console and verify MODEL_URL and server CORS settings.';
                }
            );
        }

        // Animation loop
        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }

        // Resize handler
        function resizeRendererToDisplaySize() {
            const canvasParent = canvas.parentElement;
            const width = canvasParent.clientWidth;
            const height = canvasParent.clientHeight;
            const needResize = canvas.width !== Math.floor(width * window.devicePixelRatio) || 
                             canvas.height !== Math.floor(height * window.devicePixelRatio);
            if (needResize) {
                renderer.setSize(width, height, false);
                camera.aspect = width / height;
                camera.updateProjectionMatrix();
            }
            return needResize;
        }

        window.addEventListener('resize', () => {
            resizeRendererToDisplaySize();
        });

        // Controls for UI
        let autoRotateEnabled = true;
        function toggleAutoRotate() {
            autoRotateEnabled = !autoRotateEnabled;
            controls.autoRotate = autoRotateEnabled;
            document.getElementById('viewer-status').textContent = autoRotateEnabled ? 
                'üîÑ Auto-rotate: ON' : '‚è∏Ô∏è Auto-rotate: OFF';
        }
        window.toggleAutoRotate = toggleAutoRotate;

        function resetCamera() {
            controls.reset();
            if (root.children.length > 0) fitModelToView(root);
            document.getElementById('viewer-status').textContent = 'üéØ Camera reset';
        }
        window.resetCamera = resetCamera;

        // Render mode switch
        document.getElementById('renderMode').addEventListener('change', (e) => {
            const mode = e.target.value;
            if (!modelMesh) return;
            modelMesh.traverse(child => {
                if (child.isMesh) {
                    if (mode === 'wireframe') child.material.wireframe = true;
                    else child.material.wireframe = false;
                }
            });
            statusEl.textContent = `üé® Render mode: ${mode}`;
        });

        // Model scale switch
        document.getElementById('modelScale').addEventListener('change', (e) => {
            const scaleVal = parseFloat(e.target.value) || 1.0;
            if (root) root.scale.setScalar(scaleVal);
            if (root.children.length > 0) fitModelToView(root);
            statusEl.textContent = `üìè Scale: ${scaleVal}x`;
        });

        // Screenshot button
        document.getElementById('btn-screenshot').addEventListener('click', () => {
            renderer.domElement.toBlob((blob) => {
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'heart-snapshot.png';
                a.click();
                URL.revokeObjectURL(url);
            }, 'image/png');
            statusEl.textContent = 'üì∏ Screenshot saved!';
            setTimeout(() => {
                statusEl.textContent = autoRotateEnabled ? 'üîÑ Auto-rotate: ON' : '‚è∏Ô∏è Auto-rotate: OFF';
            }, 2000);
        });

        // Fit / center button
        document.getElementById('btn-centered').addEventListener('click', () => {
            if (root.children.length > 0) fitModelToView(root);
            statusEl.textContent = 'üéØ Model centered';
            setTimeout(() => {
                statusEl.textContent = autoRotateEnabled ? 'üîÑ Auto-rotate: ON' : '‚è∏Ô∏è Auto-rotate: OFF';
            }, 2000);
        });

        // Start
        resizeRendererToDisplaySize();
        loadModel();
        animate();

        // Safety check
        if (!renderer.capabilities.isWebGL2 && !renderer.capabilities.isWebGL1) {
            console.error('WebGL not supported');
            errorBox.style.display = 'block';
            errorBox.textContent = '‚ö†Ô∏è WebGL not supported in this browser.';
        }

        // Expose for debug
        window.THREE_APP = { renderer, scene, camera, controls, root };
    </script>
</body>
</html>
