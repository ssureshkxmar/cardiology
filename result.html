<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ü´Ä AI Cardiac Analysis Results</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ================= RESET ================= */
*{margin:0;padding:0;box-sizing:border-box}

/* ================= THEME ================= */
:root{
  --glass-bg: rgba(0,0,0,0.75);
  --glass-border: rgba(255,255,255,0.1);
  --glass-shadow: 0 12px 40px rgba(0,0,0,0.6);
  --glass-hover: rgba(255,255,255,0.08);
  --primary-gradient: linear-gradient(135deg,#00d4ff,#0099ff);
  --danger-gradient: linear-gradient(135deg,#ff006e,#ff4d4d);
  --success-gradient: linear-gradient(135deg,#06ffa5,#00d4ff);
  --text-primary: rgba(255,255,255,0.95);
  --text-secondary: rgba(255,255,255,0.7);
  --text-muted: rgba(255,255,255,0.5);
  --backdrop-blur: blur(20px);
}

body{
  margin:0;
  font-family:'Inter',Segoe UI,Arial,sans-serif;
  background:#000;
  color:#fff;
  padding-top:0;
}

.container{
  max-width:1400px;
  margin:auto;
  padding:30px;
}

h1{
  text-align:center;
  background:linear-gradient(135deg,#fff,#00d4ff);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}

.section{
  background:rgba(255,255,255,0.05);
  border-radius:18px;
  padding:24px;
  margin-bottom:28px;
  border:1px solid var(--glass-border);
}

.section h2{
  color:#00d4ff;
  margin-bottom:16px;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:16px;
}

.card{
  background:rgba(255,255,255,0.06);
  border-radius:14px;
  padding:16px;
}

.label{
  font-size:.8rem;
  color:#aaa;
}

.value{
  font-size:1.1rem;
  font-weight:600;
}

.badge{
  padding:6px 14px;
  border-radius:20px;
  font-weight:700;
  font-size:.8rem;
  display:inline-block;
}

.high{background:#ff006e;color:#000}
.moderate{background:#ffd700;color:#000}
.low{background:#06ffa5;color:#000}

.disease{
  margin-bottom:16px;
}

img{
  width:100%;
  border-radius:12px;
}

.actions{
  display:flex;
  gap:16px;
  justify-content:center;
  margin-top:30px;
  flex-wrap:wrap;
}

button{
  padding:12px 22px;
  border:none;
  border-radius:12px;
  font-weight:700;
  cursor:pointer;
  transition:all 0.3s ease;
}

button:hover{
  transform:translateY(-2px);
}

.primary{
  background:#00d4ff;
  color:#000;
}

.secondary{
  background:#444;
  color:#fff;
}

.danger{
  background:#ff006e;
  color:#fff;
}

/* TOP GOV HEADER */
.gov-topbar {
  background: rgba(0, 0, 0, 0.95);
  backdrop-filter: var(--backdrop-blur);
  -webkit-backdrop-filter: var(--backdrop-blur);
  border-bottom: 1px solid var(--glass-border);
  padding: 10px 28px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: sticky;
  top: 0;
  z-index: 1200;
  box-shadow: 0 4px 24px rgba(0, 0, 0, 0.3);
}

.gov-topbar-left {
  display: flex;
  align-items: center;
  gap: 14px;
}

.gov-emblem {
  width: 50px;
  height: 50px;
  border-radius: 8px;
  background: #000000;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 2px;
  position: relative;
  overflow: hidden;
}

.gov-emblem img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  filter: brightness(1.1) contrast(1.2) drop-shadow(0 0 10px rgba(218, 165, 32, 0.6));
  mix-blend-mode: screen;
}

.gov-topbar-text {
  display: flex;
  flex-direction: column;
}

.gov-topbar-text span:first-child {
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  color: var(--text-muted);
  font-weight: 600;
}

.gov-topbar-text span:last-child {
  font-size: 1rem;
  font-weight: 700;
  background: var(--primary-gradient);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.gov-topbar-right {
  font-size: 0.85rem;
  color: var(--text-secondary);
  font-weight: 500;
}

/* APP HEADER BAND */
.app-header {
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: var(--backdrop-blur);
  -webkit-backdrop-filter: var(--backdrop-blur);
  border-bottom: 1px solid var(--glass-border);
  padding: 20px 28px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: relative;
  overflow: hidden;
}

.app-header-left {
  display: flex;
  align-items: center;
  gap: 16px;
  position: relative;
  z-index: 1;
}

.back-button {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 10px 16px;
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: var(--backdrop-blur);
  -webkit-backdrop-filter: var(--backdrop-blur);
  border: 1px solid var(--glass-border);
  border-radius: 12px;
  color: var(--text-primary);
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  text-decoration: none;
}

.back-button:hover {
  background: var(--glass-hover);
  transform: translateX(-4px);
  border-color: rgba(0, 212, 255, 0.5);
}

.app-header-content {
  display: flex;
  flex-direction: column;
}

.app-title {
  font-size: 1.4rem;
  font-weight: 700;
  letter-spacing: -0.01em;
  background: linear-gradient(135deg, #fff 0%, #00d4ff 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.app-subtitle {
  font-size: 0.85rem;
  color: var(--text-secondary);
  margin-top: 4px;
}

@media(max-width:768px){
  .gov-topbar {
    padding: 8px 16px;
  }

  .gov-emblem {
    width: 40px;
    height: 40px;
  }

  .gov-topbar-text span:last-child {
    font-size: 0.85rem;
  }

  .gov-topbar-right {
    display: none;
  }

  .app-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 12px;
    padding: 16px;
  }

  .container{
    padding:20px;
  }

  .actions{
    flex-direction:column;
  }

  button{
    width:100%;
  }
}
</style>
</head>

<body>
<!-- TOP GOV HEADER -->
<div class="gov-topbar">
  <div class="gov-topbar-left">
    <div class="gov-emblem">
      <img src="image.jpg" alt="Student of India Emblem">
    </div>
    <div class="gov-topbar-text">
      <span>Student of India</span>
      <span>Health and Family Welfare</span>
    </div>
  </div>
  <div class="gov-topbar-right">
    Cardiology AI | Pilot | Internal Use Only
  </div>
</div>

<!-- APP HEADER BAND -->
<div class="app-header">
  <div class="app-header-left">
    <a href="http://localhost:8000" class="back-button">
      <span>‚Üê</span>
      <span>Back</span>
    </a>
    <div class="app-header-content">
      <span class="app-title">ü´Ä AI Cardiac Analysis Results</span>
      <span class="app-subtitle">Comprehensive diagnostic report with AI-powered insights</span>
    </div>
  </div>
</div>

<div class="container">
<h1>ü´Ä AI Cardiac Analysis Results</h1>
<div id="content"></div>

<div class="actions">
  <button class="primary" onclick="location.href='analyze.html'">New Analysis</button>
  <button class="secondary" onclick="window.print()">Print Report</button>
  <button class="danger" onclick="clearData()">Clear Data</button>
</div>
</div>

<script>
const raw = sessionStorage.getItem("analysisResult");
if(!raw){
  document.getElementById("content").innerHTML="<div class='section'><p>No analysis data found. Please perform a new analysis.</p></div>";
}else{
  render(JSON.parse(raw));
}

function severity(risk){
  if(risk >= 0.75) return ["High","high"];
  if(risk >= 0.50) return ["Moderate","moderate"];
  return ["Low","low"];
}

function render(d){
  let html = "";

  /* ================= PATIENT INFO ================= */
  const p = d.patient_info;
  html += `
  <div class="section">
  <h2>Patient Information</h2>
  <div class="grid">
    <div class="card"><div class="label">Name</div><div class="value">${p.name}</div></div>
    <div class="card"><div class="label">Age</div><div class="value">${p.age}</div></div>
    <div class="card"><div class="label">Sex</div><div class="value">${p.sex}</div></div>
  </div>
  </div>`;

  /* ================= AI SUMMARY ================= */
  const ai = d.ai_analysis;
  html += `
  <div class="section">
  <h2>AI Analysis Summary</h2>
  <p><strong>Finding:</strong> ${ai.finding}</p>
  <p><strong>Confidence:</strong> ${ai.confidence_score}</p>
  <p>${ai.explanation}</p>
  </div>`;

  /* ================= DISEASES ================= */
  html += `<div class="section"><h2>Detected Conditions</h2>`;
  ai.diseases.forEach(x=>{
    const [label,cls]=severity(x.risk);
    html += `
    <div class="card disease">
      <h3>${x.name}</h3>
      <span class="badge ${cls}">${label} Risk (${Math.round(x.risk*100)}%)</span>
      <p style="margin-top:10px">${x.description}</p>
    </div>`;
  });
  html += `</div>`;

  /* ================= HEART STRUCTURES ================= */
  html += `<div class="section"><h2>Cardiac Structure Volumes</h2><div class="grid">`;
  ai.label_stats.forEach(s=>{
    html += `
    <div class="card">
      <div class="label">${s.structure}</div>
      <div class="value">${s.volume_cm3} cm¬≥</div>
    </div>`;
  });
  html += `</div></div>`;

  /* ================= IMAGES ================= */
  const s = d.slices;
  html += `
  <div class="section">
  <h2>CT / MRI Slices</h2>
  <div class="grid">
    <div class="card"><h4>Axial</h4><img src="${s.axial}"></div>
    <div class="card"><h4>Coronal</h4><img src="${s.coronal}"></div>
    <div class="card"><h4>Sagittal</h4><img src="${s.sagittal}"></div>
  </div>
  </div>`;

  document.getElementById("content").innerHTML = html;
}

// Clear all data function
function clearData(){
  if(confirm('‚ö†Ô∏è Are you sure you want to clear all analysis data? This cannot be undone.')){
    // Clear session storage
    sessionStorage.removeItem('analysisResult');

    // Clear any other related data
    sessionStorage.clear();

    // Show confirmation
    alert('‚úÖ All data has been cleared successfully!');

    // Redirect to home or show empty state
    document.getElementById("content").innerHTML="<div class='section'><p style='text-align:center'>All data cleared. Please perform a new analysis.</p></div>";

    // Optionally redirect to analyze page after a short delay
    setTimeout(()=>{
      location.href = 'analyze.html';
    }, 1500);
  }
}
</script>
</body>
</html>